!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-time-format"),require("crypto-js/enc-hex"),require("crypto-js/hmac-sha256"),require("crypto-js/sha256"),require("uri-js")):"function"==typeof define&&define.amd?define(["exports","d3-time-format","crypto-js/enc-hex","crypto-js/hmac-sha256","crypto-js/sha256","uri-js"],t):t(e.sn=e.sn||{},e.d3,e.CryptoJS.Hex,e.CryptoJS.HmacSHA256,e.CryptoJS.SHA256,e.URI)}(this,function(e,t,n,r,i,a){"use strict";function o(e){var t=Object.create(null);if(e){var n=!0,r=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var s=a.value,c=w(s,2),l=c[0],h=c[1];t[l]=h instanceof Map?o(h):h}}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}}return t}function u(e){var t=new Map;if(e){var n=!0,r=!1,i=void 0;try{for(var a,o=Object.keys(e)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,c=e[s];t.set(s,"object"===(void 0===c?"undefined":_(c))?u(c):c)}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}}return t}function s(e){var t=null;return e instanceof Set?t=e.size>0?e:null:Array.isArray(e)?t=e.length>0?new Set(e):null:e&&(t=new Set([e])),t}function c(e,t){var n=s(e),r=s(t);if(null===n&&null===r)return null;if(null===r)return n;if(null===n)return r;var i=!0,a=!1,o=void 0;try{for(var u,c=r.values()[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var l=u.value;n.add(l)}}catch(e){a=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw o}}return n}function l(e,t){return e.getUTCFullYear()+(e.getUTCMonth()<9?"0":"")+(e.getUTCMonth()+1)+(e.getUTCDate()<10?"0":"")+e.getUTCDate()+(t?"T"+(e.getUTCHours()<10?"0":"")+e.getUTCHours()+(e.getUTCMinutes()<10?"0":"")+e.getUTCMinutes()+(e.getUTCSeconds()<10?"0":"")+e.getUTCSeconds()+"Z":"")}function h(e,t,n,r){var i=t.toLowerCase(),a=e.mappings[i];if(a||(a={key:t,val:[]},e.mappings[i]=a,e.mappingNames.push(i)),r&&(a.val.length=0),Array.isArray(n))for(var o=n.length,u=0;u<o;u+=1)a.val.push(n[u]);else a.val.push(n);return e}function d(e,t){return function(){return e.map[t]}}function f(e,t){return function(n){e.map[t]=n}}function y(e,t){Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:d(e,t),set:f(e,t)})}function p(e){var t,n,r,i,a,o,u={};if(void 0!==e&&e.length>0)for(e.match(/^\?/)&&(e=e.substring(1)),r=0,i=(t=e.split("&")).length;r<i;r++)2===(n=t[r].split("=",2)).length&&(a=decodeURIComponent(n[0]),o=decodeURIComponent(n[1]),u[a]?(Array.isArray(u[a])||(u[a]=[u[a]]),u[a].push(o)):u[a]=o);return u}function v(e){var t=e.toLowerCase();return function(e){return t===e.toString().toLowerCase()}}function m(e){for(var t=[],n=e.length,r=0;r<n;r+=1)t.push(e[r].toLowerCase());return t.sort(),t}function g(e){return"%"+e.charCodeAt(0).toString(16)}function k(e){return encodeURIComponent(e).replace(/[!'()*]/g,g)}n=n&&"default"in n?n.default:n,r=r&&"default"in r?r.default:r,i=i&&"default"in i?i.default:i;var _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},U=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(r)},S=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},A=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},w=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),I=function(){function e(t){P(this,e),this._name=t,this.constructor===e&&Object.freeze(this)}return U(e,[{key:"name",get:function(){return this._name}}],[{key:"enumValues",value:function(){return[]}},{key:"enumsValue",value:function(e){return Object.freeze(e.reduce(function(e,t){return e[t.name]=t,e},{}))}}]),e}(),T=function(e){function t(e,n){P(this,t);var r=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._value=n,r.constructor===t&&Object.freeze(r),r}return S(t,I),U(t,[{key:"compareTo",value:function(e){return this.value<e.value?-1:this.value>e.value?1:0}},{key:"value",get:function(){return this._value}}],[{key:"minimumEnumSet",value:function(e,t){if(!e)return null;var n=t?t.get(e.name):void 0;if(n)return n;n=new Set;var r=!0,i=!1,a=void 0;try{for(var o,u=e.constructor.enumValues()[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;s.compareTo(e)>-1&&n.add(s)}}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return t&&t.set(e.name,n),n.size>0?n:null}}]),t}(),O=function(e){function t(e,n){P(this,t);var r=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.constructor===t&&Object.freeze(r),r}return S(t,T),U(t,[{key:"level",get:function(){return this.value}}],[{key:"enumValues",value:function(){return M}}]),t}(),M=Object.freeze([new O("Minute",60),new O("FiveMinute",300),new O("TenMinute",600),new O("FifteenMinute",900),new O("ThirtyMinute",1800),new O("Hour",3600),new O("HourOfDay",3600),new O("SeasonalHourOfDay",3600),new O("Day",86400),new O("DayOfWeek",86400),new O("SeasonalDayOfWeek",86400),new O("Week",604800),new O("WeekOfYear",604800),new O("Month",2419200),new O("RunningTotal",Number.MAX_SAFE_INTEGER)]),N=O.enumsValue(M),H=function(e){function t(e){P(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.constructor===t&&Object.freeze(n),n}return S(t,I),U(t,null,[{key:"enumValues",value:function(){return D}}]),t}(),D=Object.freeze([new H("Active"),new H("Disabled")]),C=H.enumsValue(D),j=function(e){function t(e){P(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.constructor===t&&Object.freeze(n),n}return S(t,I),U(t,null,[{key:"enumValues",value:function(){return E}}]),t}(),E=Object.freeze([new j("ReadNodeData"),new j("User")]),R=j.enumsValue(E),L=function(){function e(t,n,r){P(this,e),this.info=t||null,this.propertyInfo=n||null,this.tags=r instanceof Set?r:Array.isArray(r)?new Set(r):null}return U(e,[{key:"toJsonEncoding",value:function(){var e={},t=this.info;t&&(e.m=o(t));var n=this.propertyInfo;n&&(e.pm=o(n));var r=this.tags;return r&&(e.t=Array.from(r)),JSON.stringify(e)}}],[{key:"fromJsonEncoding",value:function(t){var n=void 0,r=void 0,i=void 0;if(t){var a=JSON.parse(t);n=a.m?u(a.m):null,r=a.pm?u(a.pm):null,i=Array.isArray(a.t)?new Set(a.t):null}return new e(n,r,i)}}]),e}(),x=function(e){function t(e){P(this,t);var n=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.constructor===t&&Object.freeze(n),n}return S(t,I),U(t,null,[{key:"enumValues",value:function(){return q}}]),t}(),q=Object.freeze([new x("Unknown"),new x("Queued"),new x("Received"),new x("Executing"),new x("Declined"),new x("Completed")]),z=x.enumsValue(q),V=function(e){function t(e,n){P(this,t);var r=A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.constructor===t&&Object.freeze(r),r}return S(t,T),U(t,[{key:"precision",get:function(){return this.value}}],[{key:"enumValues",value:function(){return W}}]),t}(),W=Object.freeze([new V("LatLong",1),new V("Block",5),new V("Street",10),new V("PostalCode",20),new V("Locality",30),new V("StateOrProvince",40),new V("Region",50),new V("TimeZone",60),new V("Country",70)]),K=V.enumsValue(W),Q=function(){function e(t,n){P(this,e),this._max=t>0?+t:0,this._offset=n>0?+n:0}return U(e,[{key:"withOffset",value:function(t){return new e(this.max,t)}},{key:"toUriEncoding",value:function(){var e="";return this.max>0&&(e+="max="+this.max),this.offset>0&&(e.length>0&&(e+="&"),e+="offset="+this.offset),e}},{key:"max",get:function(){return this._max}},{key:"offset",get:function(){return this._offset}}]),e}(),F=function(){function e(t,n,r,i,a,o,u,c){P(this,e),this._nodeIds=s(t),this._sourceIds=s(n),this._aggregations=s(r),this._minAggregation=i instanceof O?i:null,this._locationPrecisions=s(a),this._minLocationPrecision=o instanceof V?o:null,this._nodeMetadataPaths=s(u),this._userMetadataPaths=s(c),this.constructor===e&&Object.freeze(this)}return U(e,[{key:"toJsonEncoding",value:function(){var e={},t=this.nodeIds;return t&&(e.nodeIds=Array.from(t)),(t=this.sourceIds)&&(e.sourceIds=Array.from(t)),(t=this.aggregations)&&(e.aggregations=Array.from(t).map(function(e){return e.name})),(t=this.locationPrecisions)&&(e.locationPrecisions=Array.from(t).map(function(e){return e.name})),(t=this.minAggregation)&&(e.length>0&&(e+="&"),e.minAggregation=t.name),(t=this.minLocationPrecision)&&(e.minLocationPrecision=t.name),(t=this.nodeMetadataPaths)&&(e.nodeMetadataPaths=Array.from(t)),(t=this.userMetadataPaths)&&(e.userMetadataPaths=Array.from(t)),JSON.stringify(e)}},{key:"nodeIds",get:function(){return this._nodeIds}},{key:"sourceIds",get:function(){return this._sourceIds}},{key:"aggregations",get:function(){return this._aggregations}},{key:"locationPrecisions",get:function(){return this._locationPrecisions}},{key:"minAggregation",get:function(){return this._minAggregation}},{key:"minLocationPrecision",get:function(){return this._minLocationPrecision}},{key:"nodeMetadataPaths",get:function(){return this._nodeMetadataPaths}},{key:"userMetadataPaths",get:function(){return this._userMetadataPaths}}]),e}(),Y=new Map,X=new Map,G=function(){function e(){P(this,e)}return U(e,[{key:"withPolicy",value:function(e){return e&&this.withAggregations(e.aggregations).withMinAggregation(e.minAggregation).withLocationPrecisions(e.locationPrecisions).withMinLocationPrecision(e.minLocationPrecision).withNodeIds(e.nodeIds).withSourceIds(e.sourceIds).withNodeMetadataPaths(e.nodeMetadataPaths).withUserMetadataPaths(e.userMetadataPaths),this}},{key:"addPolicy",value:function(e){return e&&(this.addAggregations(e.aggregations).addLocationPrecisions(e.locationPrecisions).addNodeIds(e.nodeIds).addSourceIds(e.sourceIds).addNodeMetadataPaths(e.nodeMetadataPaths).addUserMetadataPaths(e.userMetadataPaths),e.minAggregation&&this.withMinAggregation(e.minAggregation),e.minLocationPrecision&&this.withMinLocationPrecision(e.minLocationPrecision)),this}},{key:"withNodeIds",value:function(e){return this.nodeIds=s(e),this}},{key:"addNodeIds",value:function(e){return this.withNodeIds(c(this.nodeIds,e))}},{key:"withNodeMetadataPaths",value:function(e){return this.nodeMetadataPaths=s(e),this}},{key:"addNodeMetadataPaths",value:function(e){return this.withNodeMetadataPaths(c(this.nodeMetadataPaths,e))}},{key:"withUserMetadataPaths",value:function(e){return this.userMetadataPaths=s(e),this}},{key:"addUserMetadataPaths",value:function(e){return this.withUserMetadataPaths(c(this.userMetadataPaths,e))}},{key:"withSourceIds",value:function(e){return this.sourceIds=s(e),this}},{key:"addSourceIds",value:function(e){return this.withSourceIds(c(this.sourceIds,e))}},{key:"withAggregations",value:function(e){return this.aggregations=s(e),this}},{key:"addAggregations",value:function(e){return this.withAggregations(c(this.aggregations,e))}},{key:"withLocationPrecisions",value:function(e){return this.locationPrecisions=s(e),this}},{key:"addLocationPrecisions",value:function(e){return this.withLocationPrecisions(c(this.locationPrecisions,e))}},{key:"withMinAggregation",value:function(e){return this.minAggregation=e,this}},{key:"buildAggregations",value:function(){var e=this.minAggregation,t=this.aggregations;return!e&&t&&t.size>0?t:e?O.minimumEnumSet(e,Y):null}},{key:"withMinLocationPrecision",value:function(e){return this.minLocationPrecision=e,this}},{key:"buildLocationPrecisions",value:function(){var e=this.minLocationPrecision,t=this.locationPrecisions;return!e&&t&&t.size>0?t:e?V.minimumEnumSet(e,X):null}},{key:"build",value:function(){return new F(this.nodeIds,this.sourceIds,this.buildAggregations(),this.minAggregation,this.buildLocationPrecisions(),this.minLocationPrecision,this.nodeMetadataPaths,this.userMetadataPaths)}}]),e}(),J=function(){function e(t,n){P(this,e),this._key=t,this._descending=!!n}return U(e,[{key:"toUriEncoding",value:function(e,t){var n=void 0,r=t||"sortDescriptors";return n=void 0!==e&&e>=0?encodeURIComponent(r+"["+e+"].key")+"=":"key=",n+=encodeURIComponent(this.key),this.descending&&(n+=void 0!==e&&e>=0?"&"+encodeURIComponent(r+"["+e+"].descending")+"=true":"&descending=true"),n}},{key:"key",get:function(){return this._key}},{key:"descending",get:function(){return this._descending}}]),e}(),Z=t.utcFormat("%Y-%m-%d %H:%M:%S.%LZ"),B=t.utcFormat("%Y-%m-%d %H:%M"),$=t.utcFormat("%Y-%m-%dT%H:%M"),ee=t.utcFormat("%Y-%m-%d"),te=t.utcParse("%Y-%m-%d %H:%M:%S.%LZ"),ne=t.utcParse("%Y-%m-%d %H:%M"),re=function(){function e(t){P(this,e),this.mappings={},this.mappingNames=[],t&&this.putAll(t)}return U(e,[{key:"add",value:function(e,t){return h(this,e,t)}},{key:"put",value:function(e,t){return h(this,e,t,!0)}},{key:"putAll",value:function(e){for(var t in e)e.hasOwnProperty(t)&&h(this,t,e[t],!0);return this}},{key:"value",value:function(e){var t=e.toLowerCase(),n=this.mappings[t];return n?n.val:void 0}},{key:"firstValue",value:function(e){var t=this.value(e);return t&&t.length>0?t[0]:void 0}},{key:"clear",value:function(){return this.mappingNames.length=0,this.mappings={},this}},{key:"remove",value:function(e){var t=e.toLowerCase(),n=this.mappingNames.indexOf(t),r=this.mappings[t];return r&&(delete this.mappings[t],this.mappingNames.splice(n,1)),r?r.val:void 0}},{key:"size",value:function(){return this.mappingNames.length}},{key:"isEmpty",value:function(){return this.size()<1}},{key:"containsKey",value:function(e){return void 0!==this.value(e)}},{key:"keySet",value:function(){for(var e=[],t=this.size(),n=0;n<t;n+=1)e.push(this.mappings[this.mappingNames[n]].key);return e}}]),e}(),ie=function(){function e(t){P(this,e),this.map={},void 0!==t&&this.values(t)}return U(e,[{key:"enabled",value:function(e){return void 0!==e&&!!this.map[e]}},{key:"toggle",value:function(e,t){var n=t;return void 0===e?this:(void 0===n&&(n=void 0===this.map[e]),this.value(e,!0===n||null))}},{key:"value",value:function(e,t){return 1===arguments.length?this.map[e]:(null===t?(delete this.map[e],this.hasOwnProperty(e)&&delete this[e]):(this.map[e]=t,this.hasOwnProperty(e)||y(this,e)),this)}},{key:"values",value:function(e){if(e){for(var t in e)e.hasOwnProperty(t)&&this.value(t,e[t]);return this}return Object.assign({},this.map)}}]),e}(),ae=function(e){function t(e){return P(this,t),A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,Object.assign({protocol:"https",host:"data.solarnetwork.net",port:e&&e.port?e.port:e&&e.protocol?"https"===e.protocol?443:80:443},e)))}return S(t,ie),U(t,[{key:"useTls",value:function(){return"https"===this.value("protocol")}}]),t}(),oe=Object.freeze({GET:"GET",HEAD:"HEAD",POST:"POST",PUT:"PUT",PATCH:"PATCH",DELETE:"DELETE",OPTIONS:"OPTIONS",TRACE:"TRACE"}),ue=function(e){function t(){return P(this,t),A(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return S(t,re),t}();Object.defineProperties(ue,{CONTENT_MD5:{value:"Content-MD5"},CONTENT_TYPE:{value:"Content-Type"},DATE:{value:"Date"},DIGEST:{value:"Digest"},HOST:{value:"Host"},X_SN_DATE:{value:"X-SN-Date"}});var se={urlQueryParse:p,urlQueryEncode:function(e,t){function n(e,t){u.length&&(u+="&"),u+=s(e)+"="+s(t)}var r,i,a,o,u="",s=t||encodeURIComponent;if(e)for(r in e)if(e.hasOwnProperty(r))if(i=e[r],Array.isArray(i))for(a=0,o=i.length;a<o;a++)n(r,i[a]);else n(r,i);return u}},ce=function(){function e(t,n){P(this,e),this.tokenId=t,this.environment=n||new ae,this.reset()}return U(e,[{key:"reset",value:function(){this.contentDigest=null,this.httpHeaders=new ue,this.parameters=new re,this.signedHeaderNames=[];var e=this.environment.host;return"https"!==this.environment.protocol&&80==this.environment.port||(e+=":"+this.environment.port),this.method(oe.GET).host(e).path("/").date(new Date)}},{key:"saveSigningKey",value:function(e){return this.signingKey=this.computeSigningKey(e),this}},{key:"method",value:function(e){return this.httpMethod=e,this}},{key:"host",value:function(e){return this.httpHeaders.put(ue.HOST,e),this}},{key:"path",value:function(e){return this.requestPath=e,this}},{key:"url",value:function(e){var t=a.parse(e),n=t.host;return t.port&&("https"===t.scheme&&443!==t.port||"http"===t.scheme&&80!==t.port)&&(n+=":"+t.port),t.query&&this.queryParams(p(t.query)),this.host(n).path(t.path)}},{key:"contentType",value:function(e){return this.httpHeaders.put(ue.CONTENT_TYPE,e),this}},{key:"date",value:function(e){return this.requestDate=e||new Date,this}},{key:"snDate",value:function(e){return this.useSnDate=e,this}},{key:"header",value:function(e,t){return this.httpHeaders.put(e,t),this}},{key:"headers",value:function(e){return this.httpHeaders=e,this}},{key:"queryParams",value:function(e){return e instanceof re?this.parameters=e:this.parameters.putAll(e),this}},{key:"signedHttpHeaders",value:function(e){return this.signedHeaderNames=e,this}},{key:"contentSHA256",value:function(e){var t;return t="string"==typeof e?n.parse(e):e,this.contentDigest=t,this}},{key:"canonicalQueryParameters",value:function(){var e=this.parameters.keySet();if(e.length<1)return"";e.sort();for(var t=e.length,n=!0,r="",i=0;i<t;i+=1)for(var a=e[i],o=this.parameters.value(a),u=o.length,s=0;s<u;s+=1)n?n=!1:r+="&",r+=k(a)+"="+k(o[s]);return r}},{key:"canonicalHeaders",value:function(e){for(var t,n,r="",i=e.length,a=0;a<i;a+=1)r+=(t=e[a])+":"+((n="date"===t||"x-sn-date"===t?this.requestDate.toUTCString():this.httpHeaders.firstValue(t))?n.trim():"")+"\n";return r}},{key:"canonicalSignedHeaderNames",value:function(e){return e.join(";")}},{key:"canonicalContentSHA256",value:function(){return this.contentDigest?n.stringify(this.contentDigest):e.EMPTY_STRING_SHA256_HEX}},{key:"canonicalHeaderNames",value:function(){var e=this.httpHeaders,t=this.signedHeaderNames,n=new re;return n.put(ue.HOST,!0),this.useSnDate?n.put(ue.X_SN_DATE,!0):n.put(ue.DATE,!0),e.containsKey(ue.CONTENT_MD5)&&n.put(ue.CONTENT_MD5,!0),e.containsKey(ue.CONTENT_TYPE)&&n.put(ue.CONTENT_TYPE,!0),e.containsKey(ue.DIGEST)&&n.put(ue.DIGEST,!0),t&&t.length>0&&t.forEach(function(e){return n.put(e,!0)}),m(n.keySet())}},{key:"buildCanonicalRequestData",value:function(){return this.computeCanonicalRequestData(this.canonicalHeaderNames())}},{key:"computeCanonicalRequestData",value:function(e){var t=this.httpMethod+"\n";return t+=this.requestPath+"\n",t+=this.canonicalQueryParameters()+"\n",t+=this.canonicalHeaders(e),t+=this.canonicalSignedHeaderNames(e)+"\n",t+=this.canonicalContentSHA256()}},{key:"computeSigningKey",value:function(e){var t=l(this.requestDate);return r("snws2_request",r(t,"SNWS2"+e))}},{key:"computeSignatureData",value:function(e){return"SNWS2-HMAC-SHA256\n"+l(this.requestDate,!0)+"\n"+n.stringify(i(e))}},{key:"buildWithKey",value:function(e){var t=this.canonicalHeaderNames(),i=this.computeCanonicalRequestData(t),a=this.computeSignatureData(i),o=n.stringify(r(a,e));return"SNWS2 Credential="+this.tokenId+",SignedHeaders="+t.join(";")+",Signature="+o}},{key:"build",value:function(e){var t=this.computeSigningKey(e);return this.buildWithKey(t)}},{key:"buildWithSavedKey",value:function(){return this.buildWithKey(this.signingKey)}},{key:"requestDateHeaderValue",get:function(){return this.requestDate.toUTCString()}},{key:"useSnDate",get:function(){var e=this.signedHeaderNames;return(Array.isArray(e)?e.findIndex(v(ue.X_SN_DATE)):-1)>=0||this.httpHeaders.containsKey(ue.X_SN_DATE)},set:function(e){var t=this.signedHeaderNames,n=Array.isArray(t)?t.findIndex(v(ue.X_SN_DATE)):-1;e&&n<0?(t=t?t.concat(ue.X_SN_DATE):[ue.X_SN_DATE],this.signedHeaderNames=t):!e&&n>=0&&(t.splice(n,1),this.signedHeaderNames=t),this.httpHeaders.remove(ue.X_SN_DATE)}}]),e}();Object.defineProperties(ce,{EMPTY_STRING_SHA256_HEX:{value:"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"},SNWS2_AUTH_SCHEME:{value:"SNWS2"}});var le=function(){function e(t){P(this,e);var n=t instanceof ae?t:new ae(t);this.environment=n,this._parameters=new ie}return U(e,[{key:"env",value:function(){var e;return(e=this.environment).value.apply(e,arguments)}},{key:"parameter",value:function(){var e;return(e=this._parameters).value.apply(e,arguments)}},{key:"hostUrl",value:function(){var e=this.environment.useTls(),t=+this.environment.value("port"),n="http"+(e?"s":"")+"://"+this.environment.value("host");return(e&&t>0&&443!==t||!e&&t>0&&80!==t)&&(n+=":"+t),n}},{key:"hostWebSocketUrl",value:function(){var e=this.environment.useTls(),t=+this.environment.value("port"),n="ws"+(e?"s":"")+"://"+this.environment.value("host");return(e&&t>0&&443!==t||!e&&t>0&&80!==t)&&(n+=":"+t),n}},{key:"baseUrl",value:function(){return this.hostUrl()}},{key:"resolveTemplatePath",value:function(e){return this.hostUrl()+this.resolveTemplateUrl(e)}},{key:"resolveTemplateUrl",value:function(t){return e.resolveTemplateUrl(t,this._parameters)}},{key:"parameters",get:function(){return this._parameters}}],[{key:"resolveTemplateUrl",value:function(e,t){return e.replace(/\{([^}]+)\}/g,function(e,n){var r=t[n];return void 0!==r?encodeURIComponent(r):""})}}]),e}(),he=function(e){return function(t){function n(){return P(this,n),A(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return S(n,e),U(n,[{key:"nodeId",get:function(){var e=this.parameter("nodeIds");return Array.isArray(e)&&e.length>0?e[0]:null},set:function(e){this.parameter("nodeIds",[e])}},{key:"nodeIds",get:function(){return this.parameter("nodeIds")},set:function(e){this.parameter("nodeIds",e)}},{key:"sourceId",get:function(){var e=this.parameter("sourceIds");return Array.isArray(e)&&e.length>0?e[0]:null},set:function(e){this.parameter("sourceIds",[e])}},{key:"sourceIds",get:function(){return this.parameter("sourceIds")},set:function(e){this.parameter("sourceIds",e)}}]),n}()},de=function(e){return function(t){function n(){return P(this,n),A(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return S(n,e),U(n,[{key:"baseUrl",value:function(){var e=this.env("solarQueryPath")||"/solarquery",t=!!this.env("publicQuery");return this.hostUrl()+e+"/api/v1"+(t?"/pub":"/sec")}}]),n}()},fe=function(e){return function(t){function n(){return P(this,n),A(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return S(n,e),U(n,[{key:"baseDatumMetadataUrl",value:function(e){return this.baseUrl()+"/datum/meta/"+(e||this.nodeId)}},{key:"datumMetadataUrlWithSource",value:function(e,t){var n=this.baseDatumMetadataUrl(e),r=t||this.sourceId;return null!==t&&r&&(n+="?sourceId="+encodeURIComponent(r)),n}},{key:"viewDatumMetadataUrl",value:function(e,t){return this.datumMetadataUrlWithSource(e,t)}},{key:"addDatumMetadataUrl",value:function(e,t){return this.datumMetadataUrlWithSource(e,t)}},{key:"replaceDatumMetadataUrl",value:function(e,t){return this.datumMetadataUrlWithSource(e,t)}},{key:"deleteDatumMetadataUrl",value:function(e,t){return this.datumMetadataUrlWithSource(e,t)}},{key:"findDatumMetadataUrl",value:function(e,t,n,r){var i=this.baseDatumMetadataUrl(e),a="",o=t||this.sourceId;return null!==t&&o&&(a+="sourceId="+encodeURIComponent(o)),Array.isArray(n)&&n.forEach(function(e,t){e instanceof J&&(a.length>0&&(a+="&"),a+=e.toUriEncoding(t))}),r instanceof Q&&(a.length>0&&(a+="&"),a+=r.toUriEncoding()),a.length>0&&(i+="?"+a),i}}]),n}()},ye=function(e){function t(){return P(this,t),A(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S(t,e),t}(fe(de(he(le)))),pe=function(e){return function(t){function n(){return P(this,n),A(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return S(n,e),U(n,[{key:"reportableIntervalUrl",value:function(e,t){var n=this.baseUrl()+"/range/interval?nodeId="+(e||this.nodeId),r=t||this.sourceIds;return Array.isArray(r)&&r.length>0&&(n+="&sourceIds="+r.map(function(e){return encodeURIComponent(e)}).join(",")),n}},{key:"availableSourcesUrl",value:function(e,t){var n=Array.isArray(e)?e:e?[e]:null!==e?this.nodeIds:void 0,r=this.baseUrl()+"/range/sources",i="";return Array.isArray(n)&&(i+="nodeIds="+n.join(",")),t&&(i.length>0&&(i+="&"),i+="metadataFilter="+encodeURIComponent(t)),i.length>0&&(r+="?"+i),r}}]),n}()},ve=function(e){function t(){return P(this,t),A(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S(t,e),t}(pe(de(he(le)))),me=function(e){return function(t){function n(){return P(this,n),A(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return S(n,e),U(n,[{key:"baseUrl",value:function(){var e=this.env("solarUserPath")||"/solaruser";return b(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"baseUrl",this).call(this)+e+"/api/v1/sec"}},{key:"viewNodesUrl",value:function(){return this.baseUrl()+"/nodes"}},{key:"viewPendingNodesUrl",value:function(){return this.baseUrl()+"/nodes/pending"}},{key:"viewArchivedNodesUrl",value:function(){return this.baseUrl()+"/nodes/archived"}},{key:"updateNodeArchivedStatusUrl",value:function(e,t){var n=Array.isArray(e)?e:e?[e]:this.nodeIds;return this.baseUrl()+"/nodes/archived?nodeIds="+n.join(",")+"&archived="+(t?"true":"false")}},{key:"userId",get:function(){var e=this.parameter("userIds");return Array.isArray(e)&&e.length>0?e[0]:null},set:function(e){this.parameter("userIds",[e])}},{key:"userIds",get:function(){return this.parameter("userIds")},set:function(e){this.parameter("userIds",e)}}]),n}()},ge=function(e){return function(t){function n(){return P(this,n),A(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return S(n,e),U(n,[{key:"viewInstructionUrl",value:function(e){return this.baseUrl()+"/instr/view?id="+encodeURIComponent(e)}},{key:"viewActiveInstructionsUrl",value:function(e){return this.baseUrl()+"/instr/viewActive?nodeId="+(e||this.nodeId)}},{key:"viewPendingInstructionsUrl",value:function(e){return this.baseUrl()+"/instr/viewPending?nodeId="+(e||this.nodeId)}},{key:"updateInstructionStateUrl",value:function(e,t){return this.baseUrl()+"/instr/updateState?id="+encodeURIComponent(e)+"&state="+encodeURIComponent(t.name)}},{key:"queueInstructionUrl",value:function(e,t,n){var r,i,a=this.baseUrl()+"/instr/add?nodeId="+(n||this.nodeId)+"&topic="+encodeURIComponent(e);if(Array.isArray(t))for(r=0,i=t.length;r<i;r++)a+="&"+encodeURIComponent("parameters["+r+"].name")+"="+encodeURIComponent(t[r].name)+"&"+encodeURIComponent("parameters["+r+"].value")+"="+encodeURIComponent(t[r].value);return a}}],[{key:"instructionParameter",value:function(e,t){return{name:e,value:t}}}]),n}()},ke=function(e){function t(){return P(this,t),A(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S(t,e),t}(ge(me(he(le)))),_e=ke.instructionParameter,Pe=function(e){return function(t){function n(){return P(this,n),A(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return S(n,e),U(n,[{key:"viewNodeMetadataUrl",value:function(e){return this.baseUrl()+"/nodes/meta/"+(e||this.nodeId)}},{key:"addNodeMetadataUrl",value:function(e){return this.viewNodeMetadataUrl(e)}},{key:"replaceNodeMetadataUrl",value:function(e){return this.viewNodeMetadataUrl(e)}},{key:"deleteNodeMetadataUrl",value:function(e){return this.viewNodeMetadataUrl(e)}},{key:"findNodeMetadataUrl",value:function(e,t,n){var r=Array.isArray(e)?e:e?[e]:null!==e?this.nodeIds:void 0,i=this.baseUrl()+"/nodes/meta",a="";return Array.isArray(r)&&(a+="nodeIds="+r.join(",")),Array.isArray(t)&&t.forEach(function(e,t){e instanceof J&&(a.length>0&&(a+="&"),a+=e.toUriEncoding(t))}),n instanceof Q&&(a.length>0&&(a+="&"),a+=n.toUriEncoding()),a.length>0&&(i+="?"+a),i}}]),n}()},Ue=function(e){function t(){return P(this,t),A(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S(t,e),t}(Pe(me(he(le)))),be=function(e){return function(t){function n(){return P(this,n),A(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return S(n,e),U(n,[{key:"listAllAuthTokensUrl",value:function(){return this.baseUrl()+"/user/auth-tokens"}},{key:"generateAuthTokenUrl",value:function(e){return this.baseUrl()+"/user/auth-tokens/generate/"+e.name}},{key:"authTokenUrl",value:function(e){return this.baseUrl()+"/user/auth-tokens/"+encodeURIComponent(e)}},{key:"deleteAuthTokenUrl",value:function(e){return this.authTokenUrl(e)}},{key:"updateAuthTokenSecurityPolicyUrl",value:function(e){return this.authTokenUrl(e)}},{key:"replaceAuthTokenSecurityPolicyUrl",value:function(e){return this.authTokenUrl(e)}},{key:"updateAuthTokenStatusUrl",value:function(e,t){return this.authTokenUrl(e)+"?status="+encodeURIComponent(t.name)}}]),n}()},Se=function(e){function t(){return P(this,t),A(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S(t,e),t}(be(me(le)));e.Aggregations=N,e.Aggregation=O,e.AuthTokenStatuses=C,e.AuthTokenStatus=H,e.AuthTokenTypes=R,e.AuthTokenType=j,e.GeneralMetadata=L,e.stringMapToObject=o,e.objectToStringMap=u,e.InstructionStates=z,e.InstructionState=x,e.LocationPrecisions=K,e.LocationPrecision=V,e.Pagination=Q,e.SecurityPolicy=F,e.SecurityPolicyBuilder=G,e.SortDescriptor=J,e.timestampFormat=Z,e.dateTimeFormat=B,e.dateTimeUrlFormat=$,e.dateFormat=ee,e.timestampParse=te,e.dateTimeParse=ne,e.dateParser=function(e){return t.isoParse(e)||te(e)||ne(e)},e.iso8601Date=l,e.dateTimeUrlParse=t.isoParse,e.dateParse=t.isoParse,e.AuthorizationV2Builder=ce,e.DatumMetadataUrlHelperMixin=fe,e.DatumMetadataUrlHelper=ye,e.Environment=ae,e.HttpHeaders=ue,e.HttpMethod=oe,e.NodeDatumUrlHelperMixin=pe,e.NodeDatumUrlHelper=ve,e.NodeInstructionUrlHelperMixin=ge,e.NodeInstructionUrlHelper=ke,e.instructionParameter=_e,e.NodeMetadataUrlHelperMixin=Pe,e.NodeMetadataUrlHelper=Ue,e.NodeUrlHelperMixin=he,e.QueryUrlHelperMixin=de,e.SolarQueryDefaultPath="/solarquery",e.SolarQueryPathKey="solarQueryPath",e.SolarQueryApiPathV1="/api/v1",e.SolarQueryPublicPathKey="publicQuery",e.UserAuthTokenUrlHelperMixin=be,e.UserAuthTokenUrlHelper=Se,e.UserUrlHelperMixin=me,e.SolarUserDefaultPath="/solaruser",e.SolarUserPathKey="solarUserPath",e.SolarUserApiPathV1="/api/v1/sec",e.UrlHelper=le,e.urlQuery=se,e.ComparableEnum=T,e.Configuration=ie,e.Enum=I,e.MultiMap=re,Object.defineProperty(e,"__esModule",{value:!0})});